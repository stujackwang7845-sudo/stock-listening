DEBUG: Parsed TWSE Disposition Items: 5
DEBUG: Parsed TPEX Disposition Items: 17
DEBUG: Final Disposition Map Keys: ['1528', '2413', '3092', '3701', '6205', '6265', '8068', '30922', '3260', '3444', '37012', '3354', '5498', '7717', '4991', '4931', '3081', '6788', '4768', '4971', '3491', '3163']
DEBUG: Day 20251217 Items: 40
DEBUG: Codes found in 20251217: ['1795', '2349', '2413', '2441', '2485', '3138', '3229', '3305', '3576', '4764', '5521', '6164', '6278', '6426', '6442', '6443', '6916', '8422', '3081', '3131', '3322', '3467', '3491', '4542', '4768', '4971', '5498', '6127', '6419', '6465', '6588', '6903', '114/12/31', '114/12/31', '114/12/31', '114/12/17', '114/12/31', '114/12/17', '114/12/31', '114/12/15']
DEBUG: Day 20251218 Items: 24
DEBUG: Codes found in 20251218: ['2337', '2344', '3047', '3060', '3138', '3533', '3653', '4967', '5521', '5522', '6706', '8422', '3081', '3152', '4768', '4903', '4909', '4971', '4979', '6244', '6739', '6788', '8043', '8074']
DEBUG: Day 20251219 Items: 22
DEBUG: 2408 found in 20251219. Clause: 二, Raw: 最近九十個營業日起迄兩個營業日之收盤價漲...
DEBUG: 2408 Added to agg_data.
DEBUG: Codes found in 20251219: ['2337', '2344', '2408', '2485', '2615', '3060', '4545', '4764', '6155', '6443', '8422', '3081', '3363', '3467', '4768', '4931', '4971', '4991', '5309', '6265', '6788', '8043']
DEBUG: Day 20251222 Items: 21
DEBUG: 2408 found in 20251222. Clause: 二, Raw: 最近六十個營業日起迄兩個營業日之收盤價漲...
DEBUG: Codes found in 20251222: ['2408', '2615', '3057', '3060', '3167', '4967', '5292', '6278', '6770', '8021', '8033', '8039', '8271', '8996', '3081', '3685', '4931', '4939', '5309', '5498', '6788']
DEBUG: Day 20251223 Items: 27
DEBUG: Codes found in 20251223: ['032454', '089508', '1735', '3008', '3057', '3167', '4916', '5522', '8021', '8033', '8039', '8996', '9938', '3323', '3324', '3363', '4729', '4909', '4931', '4979', '4991', '5309', '5498', '6134', '6218', '7402', '8431']
DEBUG: Day 20251224 Items: 33
DEBUG: 2408 found in 20251224. Clause: 二, Raw: 最近六十個營業日起迄兩個營業日之收盤價漲...
DEBUG: Codes found in 20251224: ['1727', '1735', '2383', '2408', '2413', '3057', '3450', '3701', '4967', '4977', '6155', '6414', '6442', '6706', '8033', '8996', '9103', '911608', '9937', '9938', '3236', '3354', '3499', '4304', '4909', '4979', '4991', '5508', '6244', '7402', '8042', '8074', '8299']
DEBUG: Day 20251226 Items: 35
DEBUG: Codes found in 20251226: ['089508', '1735', '2413', '2493', '3006', '3057', '3167', '3450', '3701', '3715', '4967', '4989', '5907', '6426', '6442', '6515', '6706', '3131', '3354', '4304', '4768', '4979', '4991', '5498', '6127', '6163', '61635', '6218', '6419', '7717', '7751', '8042', '8043', '8111', '8299']
DEBUG: Day 20251229 Items: 37
DEBUG: Codes found in 20251229: ['1528', '2211', '2413', '2762', '3092', '3406', '3450', '3669', '3701', '4927', '4989', '6205', '6414', '7610', '8033', '8996', '9110', '1815', '18156', '3260', '3354', '3444', '3663', '4304', '4768', '4909', '5274', '5340', '5475', '5498', '61635', '6234', '7402', '7717', '8074', '8111', '8299']
DEBUG: Day 20251230 Items: 41
DEBUG: 2408 found in 20251230. Clause: 二, Raw: 最近六十個營業日起迄兩個營業日之收盤價漲...
DEBUG: Codes found in 20251230: ['1528', '1721', '2027', '2211', '2344', '2408', '2413', '2493', '3006', '3092', '3167', '3481', '3661', '3701', '4989', '6205', '6442', '6443', '6770', '7610', '8021', '8033', '8271', '8438', '1815', '3260', '3354', '3444', '3499', '3663', '4909', '4979', '5475', '5498', '6265', '7402', '7717', '8043', '8068', '8074', '8088']
DEBUG: Day 20251231 Items: 34
DEBUG: Codes found in 20251231: ['1528', '1721', '2027', '2413', '3006', '3092', '3135', '3167', '3308', '3481', '3701', '4967', '4989', '6205', '6442', '8021', '8422', '8438', '9938', '3114', '31351', '3260', '3264', '3363', '3444', '4768', '4979', '5475', '5498', '6233', '6265', '7728', '8068', '8299']
DEBUG: Fetched 20260102 -> TWSE: 18, TPEX: 19, Total: 37
DEBUG: Day 20260102 Items: 37
DEBUG: 2408 found in 20260102. Clause: 二, Raw: 最近九十個營業日起迄兩個營業日之收盤價漲...
DEBUG: Codes found in 20260102: ['1528', '1721', '2027', '2344', '2408', '3006', '3008', '3092', '3135', '3308', '3481', '3535', '4967', '4989', '6205', '6770', '8422', '8438', '30061', '31351', '3260', '3264', '3363', '3455', '4304', '4749', '4772', '4979', '5351', '5452', '6265', '7728', '7734', '8068', '8358', '84221', '8431']
DEBUG 1528 RAW: Period='115/01/02～115/01/15' Start='2026-01-02 00:00:00' End='2026-01-15 00:00:00'
DEBUG 2413 RAW: Period='115/01/02～115/01/19' Start='2026-01-02 00:00:00' End='2026-01-19 00:00:00'
DEBUG 3354: Period='1141231~1150114' Start='2025-12-31 00:00:00'
  Hist Dates: ['12/18', '12/19', '12/22', '12/23', '12/24', '12/26', '12/29', '12/30', '12/31', '01/02']
2026-01-03 17:08:05.880 | INFO     | FinMind.data.finmind_api:get_data:171 - download Dataset.TaiwanStockPrice, data_id: 2408
2026-01-03 17:08:06.544 | INFO     | FinMind.data.finmind_api:get_data:171 - download TaiwanStockPER, data_id: 2408
E:\Vibe Coding\Stock\處置股\core\fetcher.py:301: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  final_df['PER'] = final_df['PER'].ffill()
